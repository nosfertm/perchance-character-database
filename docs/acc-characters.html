<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Perchance DB</title>

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/font/bootstrap-icons.css" rel="stylesheet">

    <!-- Font Awesome via CDN -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

    <!-- Custom CSS -->
    <link href="css/main.css" rel="stylesheet">
    <link href="css/theme.css" rel="stylesheet">
    <link href="css/acc-characters.css" rel="stylesheet">

    <!-- Vue 3 and Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/vue@3.3.4/dist/vue.global.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Pinia and VueDemi -->
    <script src="https://cdn.jsdelivr.net/npm/vue-demi@0.14.6/lib/index.iife.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/pinia@2.1.7/dist/pinia.iife.js"></script>
</head>

<body>
    <div id="app" v-cloak class="d-flex flex-column min-vh-100">

        <!-- Login modal component -->
        <login-modal-component></login-modal-component>

        <!-- MODAL CHARACTER DETAIL -->
        <div class="modal fade" id="characterModal" tabindex="-1" aria-labelledby="characterModalLabel"
            data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel">
            <div class="modal-dialog modal-dialog-centered modal-xl">
                <div v-if="selectedCharacter" class="modal-content"
                    :class="{ 'bg-dark text-light': stTheme.isDarkMode }">
                    <!-- Title -->
                    <div class="modal-header" :class="{ 'bg-dark text-white border-secondary': stTheme.isDarkMode }">
                        <div class="d-flex flex-column" style="max-width: 65%; padding-right: 5px;">
                            <h5 class="modal-title mb-0" id="characterModalLabel"
                                :class="{ 'text-white': stTheme.isDarkMode }">
                                {{decodeText(this.selectedCharacter.manifest.name)}}
                            </h5>
                            <small class="text-truncate"
                                :class="{ 'text-secondary': stTheme.isDarkMode, 'text-muted': !stTheme.isDarkMode }">
                                by {{decodeText(selectedCharacter.manifest.author) || 'Anonymous'}}
                            </small>
                        </div>
                        <div class="d-flex gap-2 align-items-center">
                            <a href="#" @click.prevent="downloadCharacterFile(selectedCharacter.manifest.downloadPath)"
                                class="btn btn-success" target="_blank">
                                <i class="bi bi-download"></i> <span class="button-text">Download</span>
                            </a>
                            <a href="#" @click.prevent="openChat(selectedCharacter.manifest?.shareUrl)"
                                class="btn btn-primary" target="_blank">
                                <i class="bi bi-chat"></i> <span class="button-text">Chat</span>
                            </a>
                            <button type="button" class="btn-close" :class="{ 'btn-close-white': stTheme.isDarkMode }"
                                data-bs-dismiss="modal" aria-label="Close" @click="handleModalClose"></button>
                        </div>
                    </div>

                    <!-- Modal Body -->
                    <div class="modal-body p-0" :class="{ 'bg-dark text-light': stTheme.isDarkMode }">
                        <div class="container-fluid">
                            <div class="row g-0">
                                <!-- Image Column -->
                                <div class="col-5 modal-image-col">
                                    <div class="character-image-wrapper">
                                        <img :src="selectedCharacter.manifest.imageUrl" class="character-modal-image"
                                            :class="{'nsfw-blur': isNsfwCharacter(selectedCharacter.manifest?.categories?.rating) && !showNsfwImages}"
                                            :alt="selectedCharacter.manifest.name || 'Character Image'"
                                            @click="handleNsfwImageClick($event)">
                                        <div v-if="isNsfwCharacter(selectedCharacter.manifest?.categories?.rating) && !showNsfwImages"
                                            class="nsfw-overlay">
                                            <i class="fa-solid fa-fire-flame-curved fa-2x"></i>
                                        </div>
                                    </div>
                                </div>

                                <!-- Content Column -->
                                <div class="col-7 modal-content-col"
                                    :class="{ 'bg-dark text-white': stTheme.isDarkMode }">
                                    <!-- Description -->
                                    <div class="content-section">
                                        <h5 class="border-bottom pb-2"
                                            :class="{ 'border-secondary': stTheme.isDarkMode }">
                                            Description</h5>
                                        <p>{{decodeText(this.selectedCharacter.manifest.description)}}</p>
                                    </div>

                                    <!-- Categories -->
                                    <!-- Categories Section -->
                                    <div class="content-section">
                                        <!-- Collapse trigger with no link styling -->
                                        <a class="d-block text-decoration-none collapse-trigger"
                                            :class="{ 'collapsed': true, 'disabled': !hasCategoryItems }"
                                            data-bs-toggle="collapse" href="#categoriesCollapse" role="button"
                                            :aria-expanded="false" aria-controls="categoriesCollapse"
                                            @click="!hasCategoryItems && $event.preventDefault()">
                                            <!-- Section header with chevron icon -->
                                            <h5 class="border-bottom pb-2 d-flex justify-content-between align-items-center"
                                                :class="{ 'border-secondary': stTheme.isDarkMode }">
                                                <div class="d-flex align-items-center">
                                                    <!-- Chevron icon that rotates based on collapse state -->
                                                    <i class="bi bi-chevron-right me-2 collapse-icon"></i>
                                                    <span
                                                        :class="{ 'text-white': stTheme.isDarkMode, 'text-dark': !stTheme.isDarkMode }">Categories</span>
                                                </div>
                                                <span class="badge bg-secondary"
                                                    :class="{ 'text-white': stTheme.isDarkMode, 'text-dark': !stTheme.isDarkMode }"
                                                    v-if="categoryCount > 0">({{categoryCount}})</span>
                                            </h5>
                                        </a>
                                        <!-- Collapsible content -->
                                        <div class="collapse" id="categoriesCollapse">
                                            <div v-for="(category, categoryName, index) in selectedCharacter.manifest.categories"
                                                class="mb-3 d-flex flex-wrap gap-2">
                                                <template
                                                    v-if="Array.isArray(category) ? category.length > 0 : category">
                                                    <h6 :class="{ 'text-white': stTheme.isDarkMode }">
                                                        {{categoryName.split(' ').map(word =>
                                                        word.charAt(0).toUpperCase() +
                                                        word.slice(1)).join(' ')}}:
                                                    </h6>
                                                    <span v-if="categoryName !== 'rating' || Array.isArray(category)"
                                                        v-for="tag in category" class="badge"
                                                        :class="isNsfwCharacter(category) ? 'bg-danger' : 'bg-primary'">{{capitalizeWords(tag)}}</span>
                                                    <span v-else class="badge"
                                                        :class="isNsfwCharacter(category) ? 'bg-danger' : 'bg-primary'">{{category}}</span>
                                                </template>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Required Characters Section -->
                                    <div class="content-section"
                                        v-if="selectedCharacter.manifest.groupSettings.requires">
                                        <!-- Collapse trigger with no link styling -->
                                        <a class="d-block text-decoration-none collapse-trigger"
                                            :class="{ 'collapsed': true, 'disabled': !hasRequiredCharacters }"
                                            data-bs-toggle="collapse" href="#requiredCollapse" role="button"
                                            :aria-expanded="false" aria-controls="requiredCollapse"
                                            @click="!hasRequiredCharacters && $event.preventDefault()">
                                            <!-- Section header with chevron icon -->
                                            <h5 class="border-bottom pb-2 d-flex justify-content-between align-items-center"
                                                :class="{ 'border-secondary': stTheme.isDarkMode }">
                                                <div class="d-flex align-items-center">
                                                    <!-- Chevron icon that rotates based on collapse state -->
                                                    <i class="bi bi-chevron-right me-2 collapse-icon"></i>
                                                    <span
                                                        :class="{ 'text-white': stTheme.isDarkMode, 'text-dark': !stTheme.isDarkMode }">Required
                                                        Characters</span>
                                                </div>
                                                <span class="badge bg-secondary"
                                                    :class="{ 'text-white': stTheme.isDarkMode, 'text-dark': !stTheme.isDarkMode }"
                                                    v-if="requiredCharCount > 0">({{requiredCharCount}})</span>
                                            </h5>
                                        </a>

                                        <!-- Collapsible content -->
                                        <div class="collapse" id="requiredCollapse">
                                            <ol class="list-group list-group-numbered">
                                                <ul v-for="char in selectedCharacter.manifest.groupSettings.requires"
                                                    class="list-unstyled">
                                                    <li class="list-group-item d-flex justify-content-between align-items-start"
                                                        :class="{ 'bg-dark text-white border-secondary': stTheme.isDarkMode }">
                                                        <div class="ms-2 me-auto">
                                                            <div class="fw-bold">{{char.name}}</div>
                                                            Reason: {{char.reason}}
                                                            <div class="mt-2 d-flex gap-2">
                                                                <!-- TODO - FIX LINKS -->
                                                                <a href="google.com" class="btn btn-success btn-sm"
                                                                    target="_blank">
                                                                    <i class="bi bi-download"></i> Download
                                                                </a>
                                                                <a href="google.com" class="btn btn-primary btn-sm"
                                                                    target="_blank">
                                                                    <i class="bi bi-chat"></i> Chat
                                                                </a>
                                                            </div>
                                                        </div>
                                                        <span class="badge rounded-pill"
                                                            :class="isNsfwCharacter(char.rating) ? 'bg-danger' : 'bg-primary'">{{char.rating}}</span>
                                                    </li>
                                                </ul>
                                            </ol>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Modal Footer -->
                    <div class="modal-footer" :class="{ 'bg-dark text-white border-secondary': stTheme.isDarkMode }">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal"
                            @click="handleModalClose">
                            Close
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- NSFW CONFIRMATION MODAL -->
        <div class="modal fade" id="nsfwConfirmModal" tabindex="-1" role="dialog" aria-modal="true"
            aria-labelledby="nsfwConfirmModalLabel">
            <div class="modal-dialog modal-dialog-centered" role="document">
                <div class="modal-content" :class="{ 'bg-dark text-white border-secondary': stTheme.isDarkMode }">
                    <div class="modal-header">
                        <h5 class="modal-title" id="nsfwConfirmModalLabel">NSFW Content Warning</h5>
                        <button type="button" data-bs-dismiss="modal" class="btn-close"
                            :class="{ 'btn-close-white': stTheme.isDarkMode }" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <p>This image contains NSFW content. Would you like to view it?</p>
                    </div>
                    <div class="modal-footer">
                        <div class="container-fluid">
                            <div class="row g-2">
                                <div class="col-12 col-sm-4">
                                    <button type="button" class="btn btn-warning w-100" @click="showSingleNsfw">Show
                                        this image</button>
                                </div>
                                <div class="col-12 col-sm-4">
                                    <button type="button" class="btn btn-danger w-100" @click="showAllNsfw">Show all
                                        images</button>
                                </div>
                                <div class="col-12 col-sm-4">
                                    <button type="button" class="btn btn-secondary w-100"
                                        data-bs-dismiss="modal">Cancel</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ----------------------------------------------------------------------- -->
        <!--                                  PAGE                                   -->
        <!-- ----------------------------------------------------------------------- -->

        <!-- Navigation -->
        <navbar-component>
            <!-- Gallery Controls - Outside collapse -->
            <div class="d-flex align-items-center order-lg-last ms-2">
                <div class="d-flex gap-2 me-2">
                    <button class="btn btn-primary" type="button" data-bs-toggle="offcanvas"
                        data-bs-target="#filterPanel" aria-controls="filterPanel"
                        @click="isFilterPanelOpen = !isFilterPanelOpen">
                        <i class="fas fa-filter"></i> <span class="d-none d-xl-inline">Filter</span>
                    </button>

                    <button class="btn btn-primary" type="button" @click="loadCategories(true), loadCharacters(true)">
                        <i class="fas fa-sync"></i> <span class="d-none d-xl-inline">Reload</span>
                    </button>
                </div>
            </div>
        </navbar-component>


        <!-- Page content -->

        <!-- Filter panel -->
        <div class="offcanvas offcanvas-end offcanvas-push custom-scrollbar" data-bs-scroll="true"
            data-bs-backdrop="false" tabindex="-1" :class="{ 'bg-dark text-white': stTheme.isDarkMode }"
            id="filterPanel" aria-labelledby="filterPanelLabel">
            <!-- Fixed part -->
            <div class="offcanvas-header" :class="{ 'bg-dark text-white': stTheme.isDarkMode }">
                <h5 class="offcanvas-title" id="filterPanelLabel">Filter Panel</h5>
                <div class="filter-panel-controls">
                    <button v-show="hasActiveFilters" class="btn btn-sm btn-secondary ms-2"
                        @click="clearFilters(); searchInput = ''">Clear filters</button>
                    <button type="button" class="btn-close" :class="{ 'btn-close-white': stTheme.isDarkMode }"
                        data-bs-dismiss="offcanvas" aria-label="Close"
                        @click="isFilterPanelOpen = !isFilterPanelOpen"></button>
                </div>
            </div>

            <div class="offcanvas-body custom-scrollbar" :class="{ 'bg-dark text-white': stTheme.isDarkMode }">

                <!-- Fixed top section -->
                <div class="filter-panel-fixed">

                    <!-- Search bar -->
                    <div class="input-group" :class="{ 'bg-dark text-white': stTheme.isDarkMode }">
                        <input type="text" class="form-control" :class="{ 'bg-dark text-white': stTheme.isDarkMode }"
                            v-model="searchInput" @keyup.enter="selectedFilters.searchText = searchInput"
                            aria-label="Text input with segmented dropdown button">
                        <button type="button" class="btn btn-outline-secondary"
                            :class="{ 'btn-dark': stTheme.isDarkMode }" data-bs-toggle="tooltip"
                            title="For a full search, click the dropdown on the right."
                            @click="selectedFilters.searchText = searchInput">
                            <i class="fas fa-search"></i>
                        </button>
                        <button type="button" class="btn btn-outline-secondary dropdown-toggle dropdown-toggle-split"
                            :class="{ 'btn-dark': stTheme.isDarkMode }" data-bs-toggle="dropdown" aria-expanded="false">
                            <span class="visually-hidden">Toggle Dropdown</span>
                        </button>
                        <ul class="dropdown-menu" :class="{ 'dropdown-menu-dark': stTheme.isDarkMode }">
                            <li><a class="dropdown-item" href="#">Normal Search</a></li>
                            <li>
                                <hr class="dropdown-divider">
                            </li>
                            <li><a class="dropdown-item" href="#">Full search</a></li>
                        </ul>
                    </div>

                    <!-- Filter results count -->
                    <div class="divider-container d-flex align-items-center mt-3">
                        <hr class="divider flex-grow-1 mx-2">
                        <small v-if="filteredCharactersCount !== totalCharacters">
                            Showing {{filteredCharactersCount}} of {{totalCharacters}} characters
                        </small>
                        <small v-if="filteredCharactersCount === totalCharacters">
                            Showing all characters ({{totalCharacters}} total)
                        </small>
                        <hr class="divider flex-grow-1 mx-2">
                    </div>
                </div>

                <!-- Scrollable categories section -->
                <div class="filter-panel-scroll">
                    <!-- Category Accordions Container -->
                    <div class="accordion" id="categoryHeader">

                        <!-- Iterate through categories, showing NSFW ones only if showNsfwTags is true -->
                        <div class="accordion-item" :class="{ 'bg-dark text-white': stTheme.isDarkMode }"
                            v-for="(category, index) in this.availableCategories" :key="index"
                            v-show="!category?.nsfw_only || (category?.nsfw_only && showNsfwTags)">

                            <!-- Accordion Header -->
                            <h2 class="accordion-header" :id="'heading' + index">
                                <button class="accordion-button" :class="{ 'bg-dark text-white': stTheme.isDarkMode }"
                                    type="button" data-bs-toggle="collapse" :data-bs-target="'#collapse' + index"
                                    aria-expanded="true" :aria-controls="'collapse' + index">
                                    {{ category.name }}
                                </button>
                            </h2>

                            <!-- Accordion Content -->
                            <div :id="'collapse' + index" class="accordion-collapse collapse"
                                :aria-labelledby="'heading' + index" data-bs-parent="#categoryHeader">
                                <div class="accordion-body">

                                    <!-- SFW Tags Section -->
                                    <div class="category-block">
                                        <!-- General tags -->
                                        <div v-if="!stateLoading" v-for="tag in category.tags.general" :key="tag"
                                            class="form-check">
                                            <input class="form-check-input" type="checkbox" :value="tag"
                                                :id="'tag-' + category.name + '-' + tag"
                                                :checked="isTagSelected(category.name, tag)"
                                                @change="handleTagSelection($event, category, tag)">
                                            <label class="form-check-label" :for="'tag-' + category.name + '-' + tag">
                                                {{ tag }}
                                            </label>
                                        </div>
                                    </div>

                                    <!-- Divider -->
                                    <div v-if="showNsfwTags && category.tags.general.length && category.tags.nsfw.length"
                                        class="divider-container d-flex align-items-center">
                                        <hr class="divider flex-grow-1 mx-2">
                                        <small>NSFW</small>
                                        <hr class="divider flex-grow-1 mx-2">
                                    </div>

                                    <!-- NSFW tags -->
                                    <div class="category-block">
                                        <div v-if="showNsfwTags && !stateLoading" v-for="tag in category.tags.nsfw"
                                            :key="tag" class="form-check">
                                            <input class="form-check-input" type="checkbox" :value="tag"
                                                :id="'nsfw-tag-' + category.name + '-' + tag"
                                                :checked="isTagSelected(category.name, tag, category)"
                                                @change="handleTagSelection($event, category, tag)">
                                            <label class="form-check-label"
                                                :for="'nsfw-tag-' + category.name + '-' + tag">
                                                {{ tag }}
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <br>

        <!-- ----------------------------------------------------------------------- -->
        <!--                                 CONTENT                                 -->
        <!-- ----------------------------------------------------------------------- -->
        <!-- Characters Grid Section -->
        <!-- Displays a responsive grid of character cards -->
        <!-- Each card shows character image, name, and action buttons -->
        <div class="container-fluid mb-2" :class="{'filter-panel-open': isFilterPanelOpen}">


            <!-- Loading placeholders -->
            <div v-if="stateLoading" class="row g-3 mb-3">
                <!-- Generate X placeholder cards -->
                <div v-for="n in 8" :key="n" class="col-12 col-sm-6 col-md-4 col-lg-3 col-xl-2.4 col-xxl-2">
                    <div class="card character-card" :class="Math.random() < 0.2 ? 'bg-danger' : 'bg-primary'"
                        aria-hidden="true">
                        <!-- Placeholder image -->
                        <div class="card-img-container position-relative placeholder-glow">
                            <span class="placeholder w-100" style="height: 200px;"></span>
                        </div>

                        <!-- Card Footer with placeholder content -->
                        <div class="card-footer">
                            <div class="card-title placeholder-glow">
                                <span class="placeholder col-8"></span>
                            </div>
                            <div class="card-actions placeholder-glow">
                                <a class="action-btn disabled placeholder col-4 me-2" tabindex="-1">
                                    <i class="fas fa-comment"></i>
                                </a>
                                <a class="action-btn disabled placeholder col-4" tabindex="-1">
                                    <i class="fas fa-download"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
         <pre>
            <!-- charactersToDisplay {{charactersToDisplay.length}} -->
            filteredCharacters {{filteredCharacters.length}}
         </pre>
            <!-- Gallery container with cards -->
            <div v-else class="character-gallery">
                <!-- Character cards grid with responsive layout -->
                <section class="container-fluid py-2" style="flex: 1 !important;">
                    <div class="row g-3">
                        <!-- Loop through filtered characters -->
                        <div v-for="character in charactersToDisplay" :key="character.path"
                            class="col-12 col-md-6 col-xl-4">

                            <!-- Character card with dynamic border style based on NSFW status -->
                            <div class="card h-100" :class="{'border border-danger': character.manifest?.is_nsfw, 
                                         'border border-success': !character.manifest?.is_nsfw,
                                         'dark-theme': stTheme.isDarkMode}" @click="openCharacterPage(character)">
                                <div class="card-body d-flex flex-column">
                                    <div class="card-content d-flex justify-content-center">

                                        <!-- Image container with NSFW blur handling -->
                                        <div class="card-img-container flex-shrink-0 py-1">
                                            <img :src="character.manifest?.imageUrl || character.manifest?.imageurl"
                                                alt="Character Image" class="img-fluid w-100 h-100 object-fit-cover"
                                                :class="{'nsfw-blur': isNsfwCharacter(character.manifest?.categories?.rating, character.manifest?.is_nsfw) && !showNsfwImages}"
                                                @click.stop="handleCharacterClick(character)">

                                            <!-- NSFW overlay with flame icon -->
                                            <div v-if="isNsfwCharacter(character.manifest?.categories?.rating, character.manifest?.is_nsfw) && !showNsfwImages"
                                                class="nsfw-overlay" @click.stop="toggleNsfw()">
                                                <i class="fa-solid fa-fire-flame-curved fa-2x"></i>
                                            </div>
                                        </div>

                                        <!-- Character information section -->
                                        <div class="character-info flex-grow-1">
                                            <!-- Title and favorite button row -->
                                            <div class="d-flex align-items-center justify-content-between mb-1">
                                                <h5 class="card-title text-truncate mb-0">
                                                    {{ decodeText(character.manifest?.name) || 'Unnamed Character' }}
                                                </h5>
                                                <i class="favorite-icon favorite ms-2 fa-lg fa-heart"
                                                    :class="{'fa-solid active': character.manifest?.is_favorited, 'fa-regular': !character.manifest?.is_favorited}"
                                                    @click.stop="toggleFavorite(character.path)">
                                                </i>
                                            </div>

                                            <!-- Author information -->
                                            <div class="author-info text-muted mb-1 text-truncate">
                                                <small class="me-1">by</small>
                                                <a :href="'author.html?id=' + character.manifest?.author_id" class="author-link" @click.stop>
                                                    {{ decodeText(character.manifest?.author) || 'Anonymous' }}
                                                </a>
                                            </div>

                                            <!-- Statistics section with responsive display -->
                                            <div class="character-stats d-flex justify-content-around align-items-center rounded-3 p-2 mb-2 mt-auto"
                                                :class="stTheme.isDarkMode ? 'bg-dark' : 'bg-body-tertiary'">

                                                <!-- Chat statistics -->
                                                <div class="text-center">
                                                    <p class="stats-label small text-muted mb-1">Chats</p>
                                                    <i class="fas fa-comments stats-icon"></i>
                                                    <p class="stats-value mb-0">{{ character.manifest.chat_clicks }}</p>
                                                </div>

                                                <!-- Download statistics -->
                                                <div class="text-center">
                                                    <p class="stats-label small text-muted mb-1">Downloads</p>
                                                    <i class="fas fa-download stats-icon"></i>
                                                    <p class="stats-value mb-0">{{ character.manifest.download_clicks }}
                                                    </p>
                                                </div>

                                                <!-- Favorites statistics -->
                                                <div class="text-center">
                                                    <p class="stats-label small text-muted mb-1">Favorites</p>
                                                    <i class="fas fa-heart stats-icon"></i>
                                                    <p class="stats-value mb-0">{{ character.manifest.favorites_count }}
                                                    </p>
                                                </div>
                                            </div>

                                            <!-- Action buttons -->
                                            <div class="character-actions d-flex gap-2">
                                                <!-- Chat button -->
                                                <a type="button" class="btn btn-primary flex-grow-1"
                                                    target="_blank"
                                                    :class="!character.manifest?.shareUrl && !character.manifest?.share_url ? 'disabled' : ''"
                                                    @click.stop="openChat(character.manifest?.shareUrl || character.manifest?.share_url)">
                                                    <span class="button-text">Chat </span>
                                                    <i class="fas fa-comment"></i>
                                                </a>

                                                <!-- Download button -->
                                                <button type="button" class="btn btn-success flex-grow-1"
                                                    :class="!character.manifest?.downloadPath && !character.manifest?.download_path ? 'disabled' : ''"
                                                    @click.stop="downloadCharacterFile(character.manifest.downloadPath || character.manifest?.download_path)">
                                                    <span class="button-text">Download </span>
                                                    <i class="fas fa-download"></i>
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
            </div>



        </div>



        <!-- Pagination -->
        <div v-if="showPagination" class="pagination-container py-2" :class="{ 'dark-theme': stTheme.isDarkTheme }">
            <nav aria-label="Navegação de páginas">
                <ul class="pagination justify-content-center">
                    <!-- Botão de página anterior - desabilitado quando estiver na primeira página -->
                    <li class="page-item" :class="{ disabled: currentPage === 1 }">
                        <a class="page-link" href="#" aria-label="Anterior" @click.prevent="goToPreviousPage"
                            :class="{ 'bg-dark text-light': stTheme.isDarkMode }">
                            <span aria-hidden="true">&laquo;</span>
                        </a>
                    </li>

                    <!-- Botão para ir para a primeira página (exibido quando há muitas páginas) -->
                    <li v-if="showFirstPageButton" class="page-item" :class="{ active: currentPage === 1 }">
                        <a class="page-link" href="#" @click.prevent="goToPage(1)"
                            :class="{ 'bg-dark text-light': stTheme.isDarkMode }">1</a>
                    </li>

                    <!-- Indicador de páginas omitidas no início -->
                    <li v-if="showLeftEllipsis" class="page-item disabled">
                        <a class="page-link" href="#" :class="{ 'bg-dark text-light': stTheme.isDarkMode }">...</a>
                    </li>

                    <!-- Páginas do meio (geradas dinamicamente) -->
                    <li v-for="page in displayedPages" :key="page" class="page-item"
                        :class="{ active: currentPage === page }">
                        <a class="page-link" href="#" @click.prevent="goToPage(page)"
                            :class="{ 'bg-dark text-light': stTheme.isDarkMode }">{{ page }}</a>
                    </li>

                    <!-- Indicador de páginas omitidas no final -->
                    <li v-if="showRightEllipsis" class="page-item disabled">
                        <a class="page-link" href="#" :class="{ 'bg-dark text-light': stTheme.isDarkMode }">...</a>
                    </li>

                    <!-- Botão para ir para a última página (exibido quando há muitas páginas) -->
                    <li v-if="showLastPageButton" class="page-item" :class="{ active: currentPage === totalPages }">
                        <a class="page-link" href="#" @click.prevent="goToPage(totalPages)"
                            :class="{ 'bg-dark text-light': stTheme.isDarkMode }">{{ totalPages }}</a>
                    </li>

                    <!-- Botão de próxima página - desabilitado quando estiver na última página -->
                    <li class="page-item" :class="{ disabled: currentPage === totalPages }">
                        <a class="page-link" href="#" aria-label="Próximo" @click.prevent="goToNextPage"
                            :class="{ 'bg-dark text-light': stTheme.isDarkMode }">
                            <span aria-hidden="true">&raquo;</span>
                        </a>
                    </li>
                </ul>
            </nav>
        </div>

        <!-- Footer component -->
        <footer-component></footer-component>

    </div>

    <!-- Script inclusions -->
    <script type="module" src="js/acc-characters.js"></script>
</body>

</html>